<%extends 'base.html' %>
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <title>TournifyX | Home</title>
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <script src="https://cdn.tailwindcss.com"></script>
 <style>
   html, body {
     margin: 0;
     padding: 0;
     height: 100%;
     overflow: hidden;
   }
 </style>
</head>
<body class="relative h-screen text-white">


 <img
   id="fallbackImage"
   src="static/images/bg.jpeg"
   alt="Background"
   class="absolute top-0 left-0 w-full h-full object-cover z-0"
 />


 <video
   id="introVideo"
   class="absolute top-0 left-0 w-full h-full object-cover z-0 hidden"
   autoplay
   muted
   playsinline
 >
   <source src="static/videos/bg_vid.mp4" type="video/mp4">
   Your browser does not support the video tag.
 </video>


 <!-- Navigation Bar -->
 <nav class="absolute top-0 left-0 w-full z-20 bg-black shadow-md">
   <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
     <div class="flex justify-between h-16 items-center">
       <div class="flex items-center space-x-4">
         <!-- Logo -->
         <img src="static/images/logo.png" alt="Logo" class="w-10 h-10">
         <div class="text-2xl font-bold text-white">
           TournifyX
         </div>
       </div>
       <div class="hidden md:flex space-x-6 items-center">
         <a href="#" class="text-gray-200 hover:text-white hover:underline">Home</a>
         <a href="{% url 'user_tournaments' %}" class="text-gray-200 hover:text-white hover:underline">Tournaments</a>
         <a href="{% url 'about' %}" class="text-gray-200 hover:text-white hover:underline">About</a>
         {% if user.is_authenticated %}
           <div class="relative group inline-block ml-6">
             <button class="px-4 py-2 bg-orange-600 text-white rounded-full font-bold focus:outline-none">
               {{ user.username }} <i class="fa fa-caret-down ml-1"></i>
             </button>
             <div class="absolute right-0 mt-2 w-56 bg-white text-black rounded-lg shadow-lg z-50 hidden group-hover:block">
               <div class="px-4 py-3 border-b border-gray-200 flex items-center space-x-3">
                 <img src="https://ui-avatars.com/api/?name={{ user.username }}&background=orange&color=fff&size=48" alt="Avatar" class="w-10 h-10 rounded-full">
                 <div>
                   <div class="font-bold text-lg">{{ user.username }}</div>
                   <div class="text-sm text-gray-600">{{ user.email }}</div>
                 </div>
               </div>
               <a href="#" class="block px-4 py-2 hover:bg-orange-100 text-orange-600 font-semibold">Profile (coming soon)</a>
               <a href="{% url 'logout' %}" class="block px-4 py-2 hover:bg-orange-100 text-orange-600 font-semibold rounded-b-lg">Logout</a>
             </div>
           </div>
         {% else %}
           <a href="{% url 'login' %}" class="hover:underline">Login</a>
           <a href="{% url 'register' %}" class="hover:underline">Register</a>
         {% endif %}
       </div>
     </div>
   </div>
 </nav>


 <!-- Main Overlay Content -->
 <div class="relative z-10 flex items-center justify-center h-full px-4">
   <div class="text-center">
     <h1 class="text-5xl font-bold mb-4">Welcome to TournifyX</h1>
     <p class="text-lg text-white/80 mb-8">Manage your tournaments like a pro.</p>
     <!-- New Tournament Button -->
     <a href="{% url 'host_tournament' %}" class="mt-6 px-8 py-3 bg-red-700 hover:bg-red-600 text-white font-semibold rounded-lg transition duration-300 shadow-lg inline-block">
       Create a Tournament
     </a>
     <!-- Join Tournament Button -->
     <a href="{% url 'join_tournament' %}" class="mt-6 ml-4 px-8 py-3 bg-yellow-600 hover:bg-yellow-700 text-white font-semibold rounded-lg transition duration-300 shadow-lg inline-block">
       Join a Tournament
     </a>
   </div>
 </div>


 <!-- Modal (Pop-up Window) -->
 <div id="myModal" class="fixed inset-0 flex items-center justify-center z-30 hidden bg-gray-900 bg-opacity-50">
   <div class="bg-white p-6 rounded-lg max-w-sm w-full">
     <h2 class="text-2xl font-bold mb-4 text-center">Get Started</h2>
     <div class="flex justify-center space-x-4">
       <button id="hostTournament" class="bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-700">Host a Tournament</button>
       <button id="joinTournament" class="bg-yellow-500 text-white px-6 py-2 rounded-lg hover:bg-yellow-700">Join a Tournament</button>
     </div>


     <!-- Hidden Forms -->
     <div id="hostForm" class="hidden mt-4">
       <h3 class="text-xl font-semibold mb-4">Host a Tournament</h3>
       <form action="/host" method="POST">
         <input type="text" name="tournamentName" placeholder="Tournament Name" class="w-full p-2 mb-4 border rounded">
         <input type="date" name="date" class="w-full p-2 mb-4 border rounded">
         <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded">Create Tournament</button>
       </form>
     </div>


     <div id="joinForm" class="hidden mt-4">
       <h3 class="text-xl font-semibold mb-4">Join a Tournament</h3>
       <form action="/join_tournament" method="POST">
         <input type="text" name="tournamentId" placeholder="Tournament ID" class="w-full p-2 mb-4 border rounded">
         <button type="submit" class="w-full bg-green-600 text-white py-2 rounded">Join Tournament</button>
       </form>
     </div>
   </div>
 </div>


 <!-- JS to handle video fallback and modal toggle -->
 <script>
   const video = document.getElementById('introVideo');
   const fallbackImage = document.getElementById('fallbackImage');
   const modal = document.getElementById('myModal');
   const openModalBtn = document.getElementById('openModal');
   const hostForm = document.getElementById('hostForm');
   const joinForm = document.getElementById('joinForm');
   const hostBtn = document.getElementById('hostTournament');
   const joinBtn = document.getElementById('joinTournament');


   // Show the video and hide the fallback image when the video is ready to play
   video.addEventListener('canplay', () => {
     fallbackImage.classList.add('hidden');
     video.classList.remove('hidden');
   });


   // Show the fallback image if the video ends
   video.addEventListener('ended', () => {
     video.classList.add('hidden');
     fallbackImage.classList.remove('hidden');
   });


   // Open modal
   openModalBtn.addEventListener('click', () => {
     modal.classList.remove('hidden');
   });


   // Show host form
   hostBtn.addEventListener('click', () => {
     hostForm.classList.remove('hidden');
     joinForm.classList.add('hidden');
   });


   // Show join form
   joinBtn.addEventListener('click', () => {
     joinForm.classList.remove('hidden');
     hostForm.classList.add('hidden');
   });


   // Close modal if clicked outside
   modal.addEventListener('click', (event) => {
     if (event.target === modal) {
       modal.classList.add('hidden');
     }
   });
 </script>


</body>
</html>
