{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}TournifyX{% endblock %}</title>
    <!-- Include Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    {% block extra_css %}{% endblock %}
    <style>
      /* Floating X and O styles */
      #floatingXs { pointer-events: none; z-index: 9999; }
      .floating-x {
        position: absolute;
        color: #fff;
        font-weight: 700;
        font-size: 14px;
        line-height: 1;
        user-select: none;
        opacity: 0;
        will-change: transform, opacity;
        transform: translateX(var(--drift,0)) translateY(0) rotate(var(--rot,0deg));
        animation-name: floatX;
        animation-fill-mode: forwards;
      }

      @keyframes floatX {
        0% { opacity: 1; transform: translateX(var(--drift,0)) translateY(0) rotate(0deg); }
        100% { opacity: 0; transform: translateX(calc(var(--drift,0) + 20px)) translateY(-140px) rotate(360deg); }
      }

      /* Floating hover animation for buttons */
      .float-on-hover {
        transition: transform 200ms ease, box-shadow 200ms ease;
      }
      .float-on-hover:hover {
        transform: translateY(-6px);
        box-shadow: 0 18px 30px rgba(0,0,0,0.35);
      }
      /* Global dropdown styling to match dark inputs */
      select, select:focus, textarea.select-like {
        background: rgba(255,255,255,0.06) !important; /* near-black */
        color: #ffffff !important;
        padding: .6rem .75rem !important;
        border-radius: .75rem !important;
        border: none !important;
        outline: none !important;
        box-shadow: none !important;
      }
      select:focus {
        box-shadow: 0 0 0 3px rgba(249,115,22,0.18) !important; /* orange focus ring */
      }
      /* Ensure native option text appears white on supported browsers */
      select option {
        background: #0b1220 !important;
        color: #ffffff !important;
      }
      /* caret styling wrapper for custom select caret in templates */
      .relative .fa-caret-down { color: #cbd5e1; }
      /* Standardized form & button styles */
      .form-input {
        display: inline-block;
        background: rgba(15, 23, 42, 0.7);
        color: #fff;
        padding: .6rem .9rem;
        border-radius: .75rem;
        border: 1px solid rgba(249,115,22,0.12);
        outline: none;
        transition: box-shadow .15s ease, transform .12s ease;
      }
      .form-input:focus {
        box-shadow: 0 0 0 4px rgba(249,115,22,0.12);
      }

      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: .5rem;
        padding: .6rem 1rem;
        border-radius: .75rem;
        font-weight: 700;
        cursor: pointer;
        transition: transform .12s ease, box-shadow .12s ease, background-color .12s ease;
        text-decoration: none;
      }
      .btn:active { transform: translateY(1px); }

      .btn-primary {
        background: #f97316; /* orange-500 */
        color: #fff;
        border: 1px solid rgba(0,0,0,0.08);
        box-shadow: 0 6px 18px rgba(249,115,22,0.12);
      }
      .btn-primary:hover { background: #ea580c; }

      .btn-secondary {
        background: rgba(255,255,255,0.06);
        color: #fff;
        border: 1px solid rgba(255,255,255,0.06);
      }
      /* Subtle global background for a classy dark look */
      .site-bg {
        background: radial-gradient(ellipse at 10% 10%, rgba(9,20,36,0.92) 0%, rgba(2,6,12,0.96) 45%), linear-gradient(180deg, rgba(3,7,18,0.85), rgba(2,4,8,1));
        background-attachment: fixed;
        background-size: cover;
      }
    </style>
</head>
<body class="site-bg text-white m-0 p-0 overflow-x-hidden">

<!-- Navigation Bar -->
<header>
  <nav class="fixed top-0 left-0 w-full z-50 py-3 px-4 bg-transparent">
    <!-- Container for navbar content -->
    <div class="max-w-7xl mx-auto flex items-center justify-between">
      <!-- Left: Logo & Brand -->
      <div class="flex items-center space-x-3">
        <a href="{% url 'home' %}" class="flex items-center space-x-3 text-white bg-orange-700/40 px-3 py-2 rounded-full shadow-md float-on-hover">
          <img src="{% static 'images/logo.png' %}" alt="Logo" class="w-10 h-10">
          <span class="hidden sm:inline text-lg md:text-2xl font-bold">TournifyX</span>
        </a>
      </div>

      <!-- Mobile hamburger (shown on small screens) -->
      <div class="sm:hidden">
        <button id="navToggle" aria-label="Toggle navigation" class="text-white bg-orange-700/40 p-2 rounded-lg focus:outline-none">
          <svg id="navOpenIcon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
          <svg id="navCloseIcon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>

      <!-- Right: Navigation Links -->
      <div id="navLinks" class="hidden sm:flex gap-5 items-center bg-orange-700/40 rounded-xl px-4 py-2 shadow-md">
      <a href="{% url 'home' %}" class="flex flex-col items-center group float-on-hover">
        <i class="fa-solid fa-house text-white text-xl group-hover:text-orange-300 transition"></i>
        <span class="text-xs text-white opacity-80 group-hover:opacity-100">Home</span>
      </a>
      <a href="{% url 'user_tournaments' %}" class="flex flex-col items-center group float-on-hover">
        <i class="fa-solid fa-trophy text-white text-xl group-hover:text-orange-300 transition"></i>
        <span class="text-xs text-white opacity-80 group-hover:opacity-100">Tournaments</span>
      </a>
      <a href="{% url 'about' %}" class="flex flex-col items-center group float-on-hover">
        <i class="fa-solid fa-circle-info text-white text-xl group-hover:text-orange-300 transition"></i>
        <span class="text-xs text-white opacity-80 group-hover:opacity-100">About</span>
      </a>
      <a href="{% url 'support' %}" class="flex flex-col items-center group float-on-hover">
        <i class="fa-solid fa-headset text-white text-xl group-hover:text-orange-300 transition"></i>
        <span class="text-xs text-white opacity-80 group-hover:opacity-100">Support</span>
      </a>
      {% if request.resolver_match.url_name in 'user_tournaments public_tournaments host_tournament join_tournament' %}
        <a href="{% url 'public_tournaments' %}" class="flex flex-col items-center group float-on-hover">
          <i class="fa-solid fa-globe text-white text-xl group-hover:text-orange-300 transition"></i>
          <span class="text-xs text-white opacity-80 group-hover:opacity-100">Public</span>
        </a>
      {% endif %}
      {% if user.is_authenticated %}
        <a href="{% url 'profile_view' user.username %}" class="flex flex-col items-center group float-on-hover">
          <i class="fa-solid fa-user text-white text-xl group-hover:text-orange-300 transition"></i>
          <span class="text-xs text-white opacity-80 group-hover:opacity-100">Profile</span>
        </a>
        <a href="{% url 'logout' %}" class="flex flex-col items-center group float-on-hover">
          <i class="fa-solid fa-right-from-bracket text-white text-xl group-hover:text-orange-300 transition"></i>
          <span class="text-xs text-white opacity-80 group-hover:opacity-100">Logout</span>
        </a>
      {% else %}
        <a href="{% url 'login' %}" class="flex flex-col items-center group float-on-hover">
          <i class="fa-solid fa-right-to-bracket text-white text-xl group-hover:text-orange-300 transition"></i>
          <span class="text-xs text-white opacity-80 group-hover:opacity-100">Login</span>
        </a>
        <a href="{% url 'register' %}" class="flex flex-col items-center group float-on-hover">
          <i class="fa-solid fa-user-plus text-white text-xl group-hover:text-orange-300 transition"></i>
          <span class="text-xs text-white opacity-80 group-hover:opacity-100">Register</span>
        </a>
      {% endif %}
      </div>
    </div>
  </nav>

  <script>
    // Simple navbar toggle for small screens
    (function(){
      const btn = document.getElementById('navToggle');
      const links = document.getElementById('navLinks');
      const openIcon = document.getElementById('navOpenIcon');
      const closeIcon = document.getElementById('navCloseIcon');
      if (!btn || !links) return;
      btn.addEventListener('click', () => {
        const isHidden = links.classList.contains('hidden');
        if (isHidden) {
          links.classList.remove('hidden');
          closeIcon.classList.remove('hidden');
          openIcon.classList.add('hidden');
        } else {
          links.classList.add('hidden');
          closeIcon.classList.add('hidden');
          openIcon.classList.remove('hidden');
        }
      });
    })();
  </script>
</header>

<script>
  // Floating X and O spawner - Global for all pages
  document.addEventListener('DOMContentLoaded', function() {
    const container = document.getElementById('floatingXs');
    if (!container) return;
    
    function spawnFloating() {
      const el = document.createElement('div');
      el.className = 'floating-x';
      
      // Randomly choose between X and O
      el.textContent = Math.random() > 0.5 ? 'âœ•' : 'O';
      
      // Random position and animation (cover full viewport)
      const left = Math.random() * 100; // 0-100% from left
      const bottom = Math.random() * 80; // 0-80% from bottom
      const drift = -40 + Math.random() * 80; // -40px to +40px drift
      const rot = -180 + Math.random() * 360; // -180 to +180 degrees
      const duration = 3000 + Math.random() * 4000; // 3-7s duration

      el.style.setProperty('--drift', `${drift}px`);
      el.style.setProperty('--rot', `${rot}deg`);
      el.style.left = `${left}%`;
      el.style.bottom = `${bottom}%`;
      el.style.animationDuration = `${duration}ms`;
      
      container.appendChild(el);
      setTimeout(() => el.remove(), duration);
    }

    // Initial burst
    for (let i = 0; i < 10; i++) {
      setTimeout(spawnFloating, i * 200);
    }

    // Continuous spawning
    const interval = setInterval(spawnFloating, 900);

    // Pause when page hidden
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) clearInterval(interval);
    });

    // Expose start/stop helpers
    window.startFloatingXs = () => {
      for (let i = 0; i < 10; i++) setTimeout(spawnFloating, i * 200);
    };
  });
</script>

<!-- Content Block - Each page controls everything below the navbar -->
<div class="pt-24">
<!-- Container for floating X and O elements (high z so visible above all content) -->
<div id="floatingXs" class="fixed inset-0 z-50 pointer-events-none"></div>

{% block content %}
<!-- Content from extending templates will go here -->
{% endblock %}
</div>

{% block extra_js %}{% endblock %}
</body>
</html>