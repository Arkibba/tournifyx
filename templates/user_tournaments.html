{% extends 'base.html' %}
{% load static %}
{% block title %}My Tournaments{% endblock %}

{% block content %}
<!-- Full Screen Background Image -->
<div 
    class="fixed inset-0 w-full h-full z-0"
    style="background-image: url('{% static 'images/bg2.png' %}'); background-size: cover; background-position: center; background-repeat: no-repeat;"
></div>

<!-- Overlay for better contrast -->
<div class="fixed inset-0 z-0 bg-black/60"></div>

<div class="min-h-screen py-10 px-4 relative z-10">
   <div class="max-w-7xl mx-auto">
       <!-- Header Section -->
       <div class="text-center mb-10">
           <div class="flex justify-center mb-4">
               <img src="{% static 'images/logo.png' %}" alt="Logo" class="w-40 h-40">
           </div>
           <h1 class="text-4xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-orange-600 mb-2">
               My Tournaments
           </h1>
           <p class="text-gray-400 text-lg">Manage your hosted and joined tournaments</p>
       </div>

       <!-- Stats Overview -->
       <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-10">
           <div class="bg-black/80 backdrop-blur-sm rounded-xl p-6 shadow-lg border-2 border-orange-500/50">
               <div class="flex items-center justify-between">
                   <div>
                       <p class="text-orange-400 text-sm font-semibold uppercase tracking-wide">Hosted</p>
                       <p class="text-white text-3xl font-bold">{{ hosted_tournaments|length }}</p>
                   </div>
                   <div class="bg-orange-500/20 rounded-full p-4">
                       <i class="fas fa-crown text-orange-400 text-2xl"></i>
                   </div>
               </div>
           </div>
           <div class="bg-black/80 backdrop-blur-sm rounded-xl p-6 shadow-lg border-2 border-green-500/50">
               <div class="flex items-center justify-between">
                   <div>
                       <p class="text-green-400 text-sm font-semibold uppercase tracking-wide">Joined</p>
                       <p class="text-white text-3xl font-bold">{{ joined_tournaments|length }}</p>
                   </div>
                   <div class="bg-green-500/20 rounded-full p-4">
                       <i class="fas fa-users text-green-400 text-2xl"></i>
                   </div>
               </div>
           </div>
       </div>

       <!-- Tabs Navigation -->
       <div class="flex justify-center mb-8">
           <div class="inline-flex bg-gray-900/80 rounded-lg p-1 backdrop-blur-sm">
               <button onclick="showTab('hosted')" id="hosted-tab" class="px-6 py-3 rounded-lg font-semibold transition-all duration-300 bg-orange-500 text-white">
                   <i class="fas fa-crown mr-2"></i>Hosted ({{ hosted_tournaments|length }})
               </button>
               <button onclick="showTab('joined')" id="joined-tab" class="px-6 py-3 rounded-lg font-semibold transition-all duration-300 text-gray-300 hover:text-white">
                   <i class="fas fa-users mr-2"></i>Joined ({{ joined_tournaments|length }})
               </button>
           </div>
       </div>

       <!-- Hosted Tournaments Section -->
       <div id="hosted-section" class="tournament-section">
           {% if hosted_tournaments %}
               <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
                   {% for tournament in hosted_tournaments %}
                       <div class="bg-black/80 backdrop-blur-sm rounded-xl shadow-xl overflow-hidden border-2 border-orange-500/30 hover:border-orange-500 transition-all duration-300 transform hover:scale-105 hover:shadow-2xl">
                           <!-- Card Header -->
                           <div class="bg-black/60 backdrop-blur-sm border-b-2 border-orange-500/50 p-4">
                               <div class="flex items-start justify-between">
                                   <div class="flex-1">
                                       <div class="flex items-center gap-2 mb-2">
                                           <i class="fas fa-crown text-yellow-300"></i>
                                           <span class="text-xs font-semibold text-orange-100 uppercase tracking-wide">Host</span>
                                       </div>
                                       <h3 class="text-xl font-bold text-white line-clamp-2">{{ tournament.name }}</h3>
                                   </div>
                                   {% if tournament.is_finished %}
                                       <span class="px-2 py-1 bg-gray-700 text-gray-300 text-xs rounded-full font-semibold">
                                           <i class="fas fa-flag-checkered mr-1"></i>Finished
                                       </span>
                                   {% elif tournament.is_active %}
                                       <span class="px-2 py-1 bg-green-500 text-white text-xs rounded-full font-semibold animate-pulse">
                                           <i class="fas fa-circle mr-1"></i>Active
                                       </span>
                                   {% else %}
                                       <span class="px-2 py-1 bg-gray-600 text-gray-300 text-xs rounded-full font-semibold">
                                           <i class="fas fa-pause mr-1"></i>Inactive
                                       </span>
                                   {% endif %}
                               </div>
                           </div>

                           <!-- Card Body -->
                           <div class="p-5 space-y-4">
                               <!-- Description -->
                               <p class="text-gray-300 text-sm line-clamp-2 min-h-[40px]">
                                   {{ tournament.description|default:"No description provided" }}
                               </p>

                               <!-- Tournament Details -->
                               <div class="space-y-2">
                                   <div class="flex items-center text-sm">
                                       <i class="fas fa-tag text-orange-400 w-5"></i>
                                       <span class="text-gray-400 ml-2">Category:</span>
                                       <span class="text-white ml-2 font-semibold">{{ tournament.get_category_display }}</span>
                                   </div>
                                   <div class="flex items-center text-sm">
                                       <i class="fas fa-trophy text-orange-400 w-5"></i>
                                       <span class="text-gray-400 ml-2">Type:</span>
                                       <span class="text-white ml-2 font-semibold">{{ tournament.get_match_type_display }}</span>
                                   </div>
                                   <div class="flex items-center text-sm">
                                       <i class="fas fa-users text-orange-400 w-5"></i>
                                       <span class="text-gray-400 ml-2">Capacity:</span>
                                       <span class="text-white ml-2 font-semibold">{{ tournament.num_participants }} players</span>
                                   </div>
                                   <div class="flex items-center text-sm">
                                       <i class="fas fa-code text-orange-400 w-5"></i>
                                       <span class="text-gray-400 ml-2">Code:</span>
                                       <span class="text-white ml-2 font-mono font-semibold">{{ tournament.code }}</span>
                                   </div>
                               </div>

                               <!-- Action Buttons -->
                               <div class="pt-4 border-t border-gray-700 space-y-2">
                                   <a href="{% url 'tournament_dashboard' tournament.id %}" class="block w-full text-center px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white font-semibold rounded-lg transition-colors">
                                       <i class="fas fa-cog mr-2"></i>Manage Tournament
                                   </a>
                                   <div class="flex gap-2">
                                       <form method="POST" class="flex-1">
                                           {% csrf_token %}
                                           <input type="hidden" name="tournament_id" value="{{ tournament.id }}">
                                           <button type="submit" name="action" value="update" class="w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors">
                                               <i class="fas fa-edit mr-1"></i>Update
                                           </button>
                                       </form>
                                       <form method="POST" class="flex-1" onsubmit="return confirm('Are you sure you want to delete this tournament? This action cannot be undone.');">
                                           {% csrf_token %}
                                           <input type="hidden" name="tournament_id" value="{{ tournament.id }}">
                                           <button type="submit" name="action" value="delete" class="w-full px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg transition-colors">
                                               <i class="fas fa-trash mr-1"></i>Delete
                                           </button>
                                       </form>
                                   </div>
                               </div>
                           </div>
                       </div>
                   {% endfor %}
               </div>
           {% else %}
               <div class="text-center py-16 bg-black/60 backdrop-blur-sm rounded-xl border-2 border-gray-700">
                   <div class="text-6xl text-gray-600 mb-4">
                       <i class="fas fa-crown"></i>
                   </div>
                   <h3 class="text-2xl font-bold text-gray-300 mb-2">No Hosted Tournaments</h3>
                   <p class="text-gray-500 mb-6">You haven't hosted any tournaments yet.</p>
                   <a href="{% url 'host_tournament' %}" class="inline-block px-6 py-3 bg-orange-500 hover:bg-orange-600 text-white font-semibold rounded-lg transition-colors">
                       <i class="fas fa-plus-circle mr-2"></i>Create Your First Tournament
                   </a>
               </div>
           {% endif %}
       </div>

       <!-- Joined Tournaments Section -->
       <div id="joined-section" class="tournament-section hidden">
           {% if joined_tournaments %}
               <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
                   {% for tournament in joined_tournaments %}
                       <div class="bg-black/80 backdrop-blur-sm rounded-xl shadow-xl overflow-hidden border-2 border-green-500/30 hover:border-green-500 transition-all duration-300 transform hover:scale-105 hover:shadow-2xl">
                           <!-- Card Header -->
                           <div class="bg-black/60 backdrop-blur-sm border-b-2 border-green-500/50 p-4">
                               <div class="flex items-start justify-between">
                                   <div class="flex-1">
                                       <div class="flex items-center gap-2 mb-2">
                                           <i class="fas fa-user-check text-green-200"></i>
                                           <span class="text-xs font-semibold text-green-100 uppercase tracking-wide">Participant</span>
                                       </div>
                                       <h3 class="text-xl font-bold text-white line-clamp-2">{{ tournament.name }}</h3>
                                   </div>
                                   {% if tournament.is_finished %}
                                       <span class="px-2 py-1 bg-gray-700 text-gray-300 text-xs rounded-full font-semibold">
                                           <i class="fas fa-flag-checkered mr-1"></i>Finished
                                       </span>
                                   {% elif tournament.is_active %}
                                       <span class="px-2 py-1 bg-green-400 text-white text-xs rounded-full font-semibold animate-pulse">
                                           <i class="fas fa-circle mr-1"></i>Active
                                       </span>
                                   {% endif %}
                               </div>
                           </div>

                           <!-- Card Body -->
                           <div class="p-5 space-y-4">
                               <!-- Description -->
                               <p class="text-gray-300 text-sm line-clamp-2 min-h-[40px]">
                                   {{ tournament.description|default:"No description provided" }}
                               </p>

                               <!-- Tournament Details -->
                               <div class="space-y-2">
                                   <div class="flex items-center text-sm">
                                       <i class="fas fa-tag text-green-400 w-5"></i>
                                       <span class="text-gray-400 ml-2">Category:</span>
                                       <span class="text-white ml-2 font-semibold">{{ tournament.get_category_display }}</span>
                                   </div>
                                   <div class="flex items-center text-sm">
                                       <i class="fas fa-trophy text-green-400 w-5"></i>
                                       <span class="text-gray-400 ml-2">Type:</span>
                                       <span class="text-white ml-2 font-semibold">{{ tournament.get_match_type_display }}</span>
                                   </div>
                                   <div class="flex items-center text-sm">
                                       <i class="fas fa-users text-green-400 w-5"></i>
                                       <span class="text-gray-400 ml-2">Capacity:</span>
                                       <span class="text-white ml-2 font-semibold">{{ tournament.num_participants }} players</span>
                                   </div>
                                   <div class="flex items-center text-sm">
                                       <i class="fas fa-code text-green-400 w-5"></i>
                                       <span class="text-gray-400 ml-2">Code:</span>
                                       <span class="text-white ml-2 font-mono font-semibold">{{ tournament.code }}</span>
                                   </div>
                               </div>

                               <!-- Action Button -->
                               <div class="pt-4 border-t border-gray-700">
                                   <a href="{% url 'tournament_dashboard' tournament.id %}" class="block w-full text-center px-4 py-2 bg-green-500 hover:bg-green-600 text-white font-semibold rounded-lg transition-colors">
                                       <i class="fas fa-eye mr-2"></i>View Tournament
                                   </a>
                               </div>
                           </div>
                       </div>
                   {% endfor %}
               </div>
           {% else %}
               <div class="text-center py-16 bg-black/60 backdrop-blur-sm rounded-xl border-2 border-gray-700">
                   <div class="text-6xl text-gray-600 mb-4">
                       <i class="fas fa-users"></i>
                   </div>
                   <h3 class="text-2xl font-bold text-gray-300 mb-2">No Joined Tournaments</h3>
                   <p class="text-gray-500 mb-6">You haven't joined any tournaments yet.</p>
                   <a href="{% url 'public_tournaments' %}" class="inline-block px-6 py-3 bg-green-500 hover:bg-green-600 text-white font-semibold rounded-lg transition-colors">
                       <i class="fas fa-search mr-2"></i>Browse Public Tournaments
                   </a>
               </div>
           {% endif %}
       </div>
   </div>
</div>

<script>
function showTab(tab) {
    // Get tab buttons
    const hostedTab = document.getElementById('hosted-tab');
    const joinedTab = document.getElementById('joined-tab');
    
    // Get sections
    const hostedSection = document.getElementById('hosted-section');
    const joinedSection = document.getElementById('joined-section');
    
    if (tab === 'hosted') {
        // Show hosted section
        hostedSection.classList.remove('hidden');
        joinedSection.classList.add('hidden');
        
        // Update tab styles
        hostedTab.classList.add('bg-orange-500', 'text-white');
        hostedTab.classList.remove('text-gray-300');
        joinedTab.classList.remove('bg-green-500', 'text-white');
        joinedTab.classList.add('text-gray-300');
    } else {
        // Show joined section
        joinedSection.classList.remove('hidden');
        hostedSection.classList.add('hidden');
        
        // Update tab styles
        joinedTab.classList.add('bg-green-500', 'text-white');
        joinedTab.classList.remove('text-gray-300');
        hostedTab.classList.remove('bg-orange-500', 'text-white');
        hostedTab.classList.add('text-gray-300');
    }
}

// Fade in animation
document.addEventListener('DOMContentLoaded', function() {
    const cards = document.querySelectorAll('.bg-gray-900\\/80');
    cards.forEach((card, index) => {
        setTimeout(() => {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
            
            setTimeout(() => {
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, 50);
        }, index * 100);
    });
});
</script>
{% endblock %}
